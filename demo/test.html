<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<title>拖拽文件</title>
	<style>
		#del{
			background: #dcdcdc;
			width:40px;
			cursor: pointer;
		}
	</style>
	<body>
		<div id="del"><span>删除</span></div>
		<div>
			<span>全选</span>
			<input type="checkbox" id="checkAll">
		</div>
		<ul id="list">
			<!-- <li>
				<input type="checkbox">
				<span>内容</span>
			</li> -->
		</ul>
	</body>
	<script src="../js/dan.js"></script>
	<script>
	let listData = [
			{
				id: '0',
				caption: 'dan测试',
				time: '2015-12-30',
				desc: '拖拽'
			},
			{
				id: '1',
				caption: 'dan后台',
				time: '2015-12-30',
				desc: '拖拽'
			},
			{
				id: '2',
				caption: 'dan前端',
				time: '2015-12-30',
				desc: '拖拽'
			},
			{
				id: '3',
				caption: 'danphp',
				time: '2015-12-30',
				desc: '拖拽'
			}
		]
		//根据数据生成html
		
		var list = $('list')
		listInit(listData);
		function listInit(listData){
			var listHtml = '';
			for(var i=0;i<listData.length;i++){
			listHtml += `
				<li>
					<input class="checkSingle" type="checkbox">
					<span>${listData[i].desc}</span>
				</li>
			`
			}
			list.innerHTML = listHtml;
		}
		

		//全选功能

		var checkAll = $('checkAll');
		var checkSingle = list.getElementsByClassName('checkSingle');
		checkAll.onclick = function(){
			
			for(var i=0;i<checkSingle.length;i++){
				checkSingle[i].checked = this.checked;
			}
		}

		//单选功能

		for(var j=0;j<checkSingle.length;j++){
			checkSingle[j].onclick = function(){
				if(!this.checked){
					checkAll.checked = false;
				}else{
					this.cleckAllFlag = false;
					for(var k=0;k<checkSingle.length;k++){
						if(!checkSingle[k].checked){
							this.cleckAllFlag = true;
							break;
						}
					}
					checkAll.checked = this.cleckAllFlag ? false : true;
				}
			}
		}

		//删除功能
		var del = $('del');
		del.onclick = function(){
			//删除结构
			delCheckList();
		}

		function delCheckList(){
			var innerList = listData;
			for(var i=0;i<checkSingle.length;i++){
				if(checkSingle[i].checked){
					innerList = innerList.splice(i, 1);
				}
			}
			listInit(innerList);
		}
		
		//查询那个input 被选中
		function whoChecked(){
			var arr = [];
			for(var i=0;i<checkSingle.length;i++){
				if(checkSingle[i].checked){
					arr.push(checkSingle[i]);
				}
			}
			return arr;
		}









	</script>
</html>
